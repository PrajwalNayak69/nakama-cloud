version: "3.8"

services:
  nakama:
    build: .
    container_name: nakama
    restart: unless-stopped
    environment:
      - DATABASE_URL=${DATABASE_URL}
    ports:
      - "7350:7350"
      - "7351:7351"
    entrypoint:
      - /bin/sh
      - -ec
      - |
        echo "ðŸš€ Running database migrations..."
        /nakama/nakama migrate up --database.address "$DATABASE_URL"

        echo "âœ… Starting Nakama server..."
        exec /nakama/nakama \
          --name nakama1 \
          --database.address "$DATABASE_URL" \
          --logger.level INFO \
          --session.token_expiry_sec 7200 \
          --runtime.path /data/modules \
          --config /nakama/data/local.yml